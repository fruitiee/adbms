import tkinter as tk
from tkinter import messagebox
import sqlite3

# ---------------- Database Setup ----------------
conn = sqlite3.connect("supermarket.db")
cursor = conn.cursor()

cursor.execute("""
CREATE TABLE IF NOT EXISTS products (
    id TEXT PRIMARY KEY,
    name TEXT,
    category TEXT,
    price REAL,
    quantity INTEGER
)
""")
conn.commit()

# ---------------- Functions ----------------
def add_product():
    try:
        cursor.execute("INSERT INTO products VALUES (?, ?, ?, ?, ?)",
                       (id_entry.get(),
                        name_entry.get(),
                        category_entry.get(),
                        float(price_entry.get()),
                        int(quantity_entry.get())))
        conn.commit()
        messagebox.showinfo("Success", "Product Added Successfully")
        clear_fields()
    except:
        messagebox.showerror("Error", "Product ID already exists or Invalid Data")

def view_products():
    output.delete(1.0, tk.END)
    cursor.execute("SELECT * FROM products")
    rows = cursor.fetchall()
    for row in rows:
        output.insert(tk.END, f"{row}\n")

def search_product():
    output.delete(1.0, tk.END)
    cursor.execute("SELECT * FROM products WHERE id=?",
                   (id_entry.get(),))
    row = cursor.fetchone()
    if row:
        output.insert(tk.END, f"{row}")
    else:
        messagebox.showinfo("Not Found", "Product not found")

def update_product():
    cursor.execute("""
    UPDATE products
    SET name=?, category=?, price=?, quantity=?
    WHERE id=?""",
                   (name_entry.get(),
                    category_entry.get(),
                    float(price_entry.get()),
                    int(quantity_entry.get()),
                    id_entry.get()))
    conn.commit()
    messagebox.showinfo("Updated", "Product Updated Successfully")
    clear_fields()

def delete_product():
    cursor.execute("DELETE FROM products WHERE id=?",
                   (id_entry.get(),))
    conn.commit()
    messagebox.showinfo("Deleted", "Product Deleted Successfully")
    clear_fields()

def clear_fields():
    id_entry.delete(0, tk.END)
    name_entry.delete(0, tk.END)
    category_entry.delete(0, tk.END)
    price_entry.delete(0, tk.END)
    quantity_entry.delete(0, tk.END)

# ---------------- GUI Design ----------------
root = tk.Tk()
root.title("Super Market Inventory System")
root.geometry("500x500")

tk.Label(root, text="Super Market Inventory", font=("Arial", 16, "bold")).pack(pady=10)

tk.Label(root, text="Product ID").pack()
id_entry = tk.Entry(root)
id_entry.pack()

tk.Label(root, text="Product Name").pack()
name_entry = tk.Entry(root)
name_entry.pack()

tk.Label(root, text="Category").pack()
category_entry = tk.Entry(root)
category_entry.pack()

tk.Label(root, text="Price").pack()
price_entry = tk.Entry(root)
price_entry.pack()

tk.Label(root, text="Quantity").pack()
quantity_entry = tk.Entry(root)
quantity_entry.pack()

tk.Button(root, text="Add Product", command=add_product).pack(pady=5)
tk.Button(root, text="View Products", command=view_products).pack(pady=5)
tk.Button(root, text="Search Product", command=search_product).pack(pady=5)
tk.Button(root, text="Update Product", command=update_product).pack(pady=5)
tk.Button(root, text="Delete Product", command=delete_product).pack(pady=5)

output = tk.Text(root, height=8)
output.pack(pady=10)

root.mainloop()
